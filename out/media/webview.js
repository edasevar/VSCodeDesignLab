(()=>{"use strict";const e=acquireVsCodeApi();let t={colors:{},tokenColors:[],semanticTokens:{}},n=[];function o(){!function(){const o=document.getElementById("panel-colors");o.innerHTML=n.map(e=>`\n    <section>\n      <h4>${e.name}</h4>\n      ${e.items.map(e=>function(e,n,o){const s=t.colors[n]||"",l=d(s);return`\n    <div class="row">\n      <div class="row-head">\n        <strong>${e}</strong>\n        <button data-locate="${n}" title="Locate in Preview">Locate</button>\n      </div>\n      <div class="row-body">\n        <input type="color" data-key="${n}" value="${a(s)}" />\n\t\t<input type="text" data-key="${n}" value="${s}" placeholder="#RRGGBB or #RRGGBBAA"/>\n\t\t<input type="range" min="0" max="100" step="1" data-alpha-key="${n}" value="${l}" title="Alpha ${l}%"/>\n        <span class="desc">${o||""}</span>\n      </div>\n    </div>`}(e.key,e.key,e.description||"")).join("")}\n    </section>\n  `).join(""),o.querySelectorAll('input[type="color"], input[type="text"]').forEach(e=>{e.addEventListener("input",s)}),o.querySelectorAll('input[type="range"][data-alpha-key]').forEach(e=>e.addEventListener("input",l)),o.querySelectorAll("button[data-locate]").forEach(t=>{t.addEventListener("click",()=>{const n=t.dataset.locate;e.postMessage({type:"LOCATE",payload:{elementId:m(n)}})})})}(),r(),u(),document.getElementById("preview").innerHTML='\n  <section class="demo" id="demo-editor" style="display:block">\n    <div id="editor" contenteditable="true" style="min-height:220px;padding:8px;border:1px solid var(--vscode-editorWidget-border)">\n      // active line, selections, cursor, hover, indent guides, etc.\n      function demo() { console.log(\'Hello theme\'); }\n    </div>\n  </section>\n  <section class="demo" id="demo-panels" style="display:none"><div>Panels</div></section>\n  <section class="demo" id="demo-problems" style="display:none"><div>Problems list</div></section>\n  <section class="demo" id="demo-terminal" style="display:none"><div>Terminal</div></section>\n  <section class="demo" id="demo-notifications" style="display:none"><div>Notifications</div></section>\n  <section class="demo" id="demo-statusbar" style="display:none"><div>Status Bar</div></section>\n  <section class="demo" id="demo-lists" style="display:none"><div>Lists/Tabs</div></section>',document.querySelectorAll(".ptab").forEach(e=>e.addEventListener("click",()=>{document.querySelectorAll(".ptab").forEach(e=>e.classList.remove("active")),e.classList.add("active");const t=e.dataset.demo;document.querySelectorAll(".demo").forEach(e=>e.style.display="none"),document.getElementById("demo-"+t).style.display="block"}))}function a(e){return/^#([0-9a-f]{6}|[0-9a-f]{8})$/i.test(e)?`#${e.replace("#","").slice(0,6)}`:"#000000"}function s(n){const o=n.target,s=o.dataset.key;let l=o.value.trim();const i=o.parentElement,r=i.querySelector('input[type="text"][data-key="'+s+'"]'),u=i.querySelector('input[type="color"][data-key="'+s+'"]'),y=i.querySelector('input[type="range"][data-alpha-key="'+s+'"]');if("color"===o.type){const e=l,t=d(r?.value||""),n=c(e,t);r.value=n,y.value=String(t),l=n}else"text"===o.type&&/^#[0-9a-f]{6}([0-9a-f]{2})?$/i.test(l)&&(u.value=a(l),y.value=String(d(l)));t.colors[s]=l,p(),e.postMessage({type:"LOCATE",payload:{elementId:m(s)}})}function l(n){const o=n.target,a=o.dataset.alphaKey,s=o.parentElement,l=s.querySelector('input[type="color"][data-key="'+a+'"]'),d=s.querySelector('input[type="text"][data-key="'+a+'"]'),r=i(parseInt(o.value,10)),u=c(l.value,r);d.value=u,t.colors[a]=u,p(),e.postMessage({type:"LOCATE",payload:{elementId:m(a)}})}function i(e){return isFinite(e)?Math.min(100,Math.max(0,e)):100}function d(e){const t=/^#[0-9a-f]{6}([0-9a-f]{2})$/i.exec(e);if(!t)return 100;const n=parseInt(t[1],16);return Math.round(n/255*100)}function c(e,t){const n=a(e).replace("#",""),o=i(t);return`#${n}${Math.round(o/100*255).toString(16).padStart(2,"0")}`}function r(){const n=document.getElementById("panel-tokens"),o=t.tokenColors.map((e,t)=>function(e,t){const n=(e.settings.fontStyle||"").split(/\s+/).filter(Boolean),o=e=>n.includes(e);return`<div class="row">\n\t\t<label>scope</label><input data-token-edit data-index="${t}" data-field="scope" value="${Array.isArray(e.scope)?e.scope.join(", "):e.scope||""}" />\n    <label>foreground</label><input data-token-edit data-index="${t}" data-field="fg" value="${e.settings.foreground||""}" />\n\t\t<fieldset style="display:inline-flex;gap:6px;border:none;padding:0;margin:0">\n\t\t\t<label><input type="checkbox" data-fs data-index="${t}" value="bold" ${o("bold")?"checked":""}/> bold</label>\n\t\t\t<label><input type="checkbox" data-fs data-index="${t}" value="italic" ${o("italic")?"checked":""}/> italic</label>\n\t\t\t<label><input type="checkbox" data-fs data-index="${t}" value="underline" ${o("underline")?"checked":""}/> underline</label>\n\t\t\t<label><input type="checkbox" data-fs data-index="${t}" value="strikethrough" ${o("strikethrough")?"checked":""}/> strikethrough</label>\n\t\t</fieldset>\n\t\t<button data-token-remove data-index="${t}">Remove</button>\n  </div>`}(e,t)).join("");n.innerHTML=`\n\t\t<button id="add-token">Add Rule</button>\n    <div>${o}</div>`,document.getElementById("add-token").addEventListener("click",()=>{t.tokenColors.push({scope:"",settings:{}}),r(),p()}),n.querySelectorAll("[data-token-edit]").forEach(n=>n.addEventListener("input",n=>{const o=n.target,a=Number(o.dataset.index),s=o.dataset.field;"scope"===s&&(t.tokenColors[a].scope=o.value),"fg"===s&&(t.tokenColors[a].settings.foreground=o.value),"fs"===s&&(t.tokenColors[a].settings.fontStyle=o.value),p(),e.postMessage({type:"LOCATE",payload:{elementId:"demo-editor"}})})),n.querySelectorAll("[data-token-remove]").forEach(n=>n.addEventListener("click",n=>{const o=Number(n.currentTarget.dataset.index);t.tokenColors.splice(o,1),r(),p(),e.postMessage({type:"LOCATE",payload:{elementId:"demo-editor"}})})),n.querySelectorAll("[data-fs]").forEach(n=>n.addEventListener("change",n=>{const o=n.target,a=Number(o.dataset.index),s=o.value,l=(t.tokenColors[a].settings.fontStyle||"").split(/\s+/).filter(Boolean),i=new Set(l);o.checked?i.add(s):i.delete(s),t.tokenColors[a].settings.fontStyle=Array.from(i).join(" ")||void 0,p(),e.postMessage({type:"LOCATE",payload:{elementId:"demo-editor"}})}))}function u(){const e=document.getElementById("panel-semantic"),n=Object.entries(t.semanticTokens);e.innerHTML=`\n    <button id="add-sem">Add Semantic</button>\n    <div>${n.map(([e,t],n)=>function(e,t,n){const o=(t.fontStyle||"").split(/\s+/).filter(Boolean),a=e=>o.includes(e);return`<div class="row">\n    <label>selector</label><input data-sem data-index="${n}" data-field="selector" value="${e}"/>\n    <label>foreground</label><input data-sem data-index="${n}" data-field="fg" value="${t.foreground||""}"/>\n\t\t<fieldset style="display:inline-flex;gap:6px;border:none;padding:0;margin:0">\n\t\t\t<label><input type="checkbox" data-sem-fs data-index="${n}" value="bold" ${a("bold")?"checked":""}/> bold</label>\n\t\t\t<label><input type="checkbox" data-sem-fs data-index="${n}" value="italic" ${a("italic")?"checked":""}/> italic</label>\n\t\t\t<label><input type="checkbox" data-sem-fs data-index="${n}" value="underline" ${a("underline")?"checked":""}/> underline</label>\n\t\t</fieldset>\n\t\t<button data-sem-remove data-index="${n}">Remove</button>\n  </div>`}(e,t,n)).join("")}</div>`,document.getElementById("add-sem").addEventListener("click",()=>{t.semanticTokens["entity.name.new"]={},u(),p()}),e.querySelectorAll("[data-sem]").forEach(e=>e.addEventListener("input",e=>{const n=e.target,o=Number(n.dataset.index),a=Object.keys(t.semanticTokens)[o];if("selector"===n.dataset.field){const e=n.value,o=t.semanticTokens[a];delete t.semanticTokens[a],t.semanticTokens[e]=o}else"fg"===n.dataset.field?t.semanticTokens[a].foreground=n.value:"fs"===n.dataset.field&&(t.semanticTokens[a].fontStyle=n.value);p()})),e.querySelectorAll("[data-sem-remove]").forEach(e=>e.addEventListener("click",e=>{const n=Number(e.currentTarget.dataset.index),o=Object.keys(t.semanticTokens)[n];delete t.semanticTokens[o],u(),p()})),e.querySelectorAll("[data-sem-fs]").forEach(e=>e.addEventListener("change",e=>{const n=e.target,o=Number(n.dataset.index),a=Object.keys(t.semanticTokens)[o],s=(t.semanticTokens[a].fontStyle||"").split(/\s+/).filter(Boolean),l=new Set(s);n.checked?l.add(n.value):l.delete(n.value),t.semanticTokens[a].fontStyle=Array.from(l).join(" ")||void 0,p()}))}function p(){e.postMessage({type:"APPLY_PREVIEW",payload:t})}function m(e){return e.startsWith("statusBar")?"demo-statusbar":e.startsWith("panel")||e.startsWith("panelSection")?"demo-panels":e.startsWith("terminal")?"demo-terminal":e.startsWith("problems")?"demo-problems":e.startsWith("tab.")||e.startsWith("editorGroupHeader")?"demo-lists":"demo-editor"}function y(e){return Array.isArray(e)?e.map(e=>e.trim()).join(","):String(e||"").trim()}window.addEventListener("message",e=>{const{type:a,payload:s}=e.data;if("BOOT"===a){n=s.categories||[];const e=s.settings||{};t.colors=e.colors||{},t.tokenColors=e.tokenColors?.textMateRules||[],t.semanticTokens=e.semanticTokens?.rules||{},o()}var l,i;"LOAD_CURRENT"===a&&(t.colors=(l=t.colors,i=s.colors||{},{...i,...l}),t.tokenColors=function(e,t){const n=new Map;for(const t of e)n.set(y(t.scope),t);for(const e of t){const t=y(e.scope);n.has(t)||n.set(t,e)}return Array.from(n.values())}(t.tokenColors,s.tokenColors||[]),t.semanticTokens=function(e,t){return{...t,...e}}(t.semanticTokens,s.semanticTokens||{}),o(),p()),"LOAD_IMPORTED"===a&&(t.colors=s.colors||{},t.tokenColors=s.tokenColors||[],t.semanticTokens=s.semanticTokens||{},o(),p()),"LOCATE"===a&&function(e){if(!e)return;const t=document.getElementById(e);t&&(t.classList.add("locate-pulse"),setTimeout(()=>t.classList.remove("locate-pulse"),1e3))}(s?.elementId)}),document.addEventListener("DOMContentLoaded",()=>{const t=e=>document.getElementById(e);t("btn-import")?.addEventListener("click",()=>e.postMessage({type:"REQUEST_IMPORT"})),t("btn-use")?.addEventListener("click",()=>e.postMessage({type:"REQUEST_USE_CURRENT"})),t("btn-blank")?.addEventListener("click",()=>e.postMessage({type:"REQUEST_START_BLANK"})),t("btn-export-json")?.addEventListener("click",()=>e.postMessage({type:"REQUEST_EXPORT_JSON"})),t("btn-export-css")?.addEventListener("click",()=>e.postMessage({type:"REQUEST_EXPORT_CSS"})),t("btn-export-vsix")?.addEventListener("click",()=>e.postMessage({type:"REQUEST_EXPORT_VSIX"})),document.querySelectorAll(".tab").forEach(e=>e.addEventListener("click",()=>{document.querySelectorAll(".tab").forEach(e=>e.classList.remove("active")),e.classList.add("active");const t=e.dataset.tab;document.querySelectorAll(".panel").forEach(e=>e.classList.remove("active")),document.getElementById("panel-"+t).classList.add("active")}));const n=document.getElementById("search");n.addEventListener("input",()=>{const e=n.value.toLowerCase();document.querySelectorAll("#panel-colors section").forEach(t=>{let n=!1;t.querySelectorAll(".row").forEach(t=>{const o=(t.textContent?.toLowerCase()||"").includes(e);t.style.display=o?"":"none",o&&(n=!0)}),t.style.display=n?"":"none"}),document.querySelectorAll("#panel-tokens .row").forEach(t=>{const n=t.textContent?.toLowerCase()||"";t.style.display=n.includes(e)?"":"none"}),document.querySelectorAll("#panel-semantic .row").forEach(t=>{const n=t.textContent?.toLowerCase()||"";t.style.display=n.includes(e)?"":"none"})}),e.postMessage({type:"REQUEST_BOOT"})})})();
//# sourceMappingURL=webview.js.map