(()=>{"use strict";let e,t;const n=acquireVsCodeApi();try{const a=n.getState&&n.getState();a&&a.model&&(e=a.model),a&&a.ui&&(t=a.ui)}catch{}let a,o,s={colors:{},tokenColors:[],semanticTokens:{}};const l=[],i=[];let d,r=0;const c=e=>JSON.parse(JSON.stringify(e)),u=()=>{const e=Date.now();e-r<500||(l.push(c(s)),l.length>50&&l.shift(),i.length=0,r=e,y())},m=()=>{if(!l.length)return;i.push(c(s));const e=l.pop();s=c(e),b(),C(),y()},p=()=>{if(!i.length)return;l.push(c(s));const e=i.pop();s=c(e),b(),C(),y()};function y(){const e=document.getElementById("btn-undo"),t=document.getElementById("btn-redo");e&&(e.disabled=0===l.length),t&&(t.disabled=0===i.length);const n=document.getElementById("status");if(n){const e=JSON.stringify(s)!==(d||"");n.textContent=`${e?"● ":""}Undo:${l.length} Redo:${i.length}`}}function v(){l.length=0,i.length=0,r=0,d=JSON.stringify(s),y()}let f=[];function b(){!function(){const e=document.getElementById("panel-colors");e.innerHTML=f.map(e=>`\n    <section>\n      <h4>${e.name}</h4>\n      ${e.items.map(e=>function(e,t,n){const a=s.colors[t]||"",o=T(a);return`\n    <div class="row">\n      <div class="row-head">\n        <strong>${e}</strong>\n        <button data-locate="${t}" title="Locate in Preview" aria-label="Locate ${t} in preview">Locate</button>\n      </div>\n      <div class="row-body">\n        <input type="color" data-key="${t}" value="${k(a)}" aria-label="Color value for ${t}" />\n\t\t<input type="text" data-key="${t}" value="${a}" placeholder="#RRGGBB or #RRGGBBAA" aria-label="Hex color for ${t}" />\n\t\t<input type="range" min="0" max="100" step="1" data-alpha-key="${t}" value="${o}" title="Alpha ${o}%" aria-label="Alpha for ${t}" />\n        <span class="desc">${n||""}</span>\n      </div>\n    </div>`}(e.key,e.key,e.description||"")).join("")}\n    </section>\n  `).join(""),e.querySelectorAll('input[type="color"], input[type="text"]').forEach(e=>{e.addEventListener("input",h)}),e.querySelectorAll('input[type="range"][data-alpha-key]').forEach(e=>e.addEventListener("input",S)),e.querySelectorAll("button[data-locate]").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.locate;n.postMessage({type:"LOCATE",payload:{elementId:I(t)}})})})}(),$(),x(),document.getElementById("preview").innerHTML='\n  <section class="demo" id="demo-editor" style="display:block">\n    <div id="editor" contenteditable="true" style="min-height:220px;padding:8px;border:1px solid var(--vscode-editorWidget-border)">\n      // active line, selections, cursor, hover, indent guides, etc.\n      function demo() { console.log(\'Hello theme\'); }\n    </div>\n  </section>\n  <section class="demo" id="demo-panels" style="display:none"><div>Panels</div></section>\n  <section class="demo" id="demo-problems" style="display:none"><div>Problems list</div></section>\n  <section class="demo" id="demo-terminal" style="display:none"><div>Terminal</div></section>\n  <section class="demo" id="demo-notifications" style="display:none"><div>Notifications</div></section>\n  <section class="demo" id="demo-statusbar" style="display:none"><div>Status Bar</div></section>\n  <section class="demo" id="demo-lists" style="display:none"><div>Lists/Tabs</div></section>',document.querySelectorAll(".ptab").forEach(e=>e.addEventListener("click",()=>{document.querySelectorAll(".ptab").forEach(e=>e.classList.remove("active")),e.classList.add("active");const t=e.dataset.demo;document.querySelectorAll(".demo").forEach(e=>e.style.display="none"),document.getElementById("demo-"+t).style.display="block",w()}))}function k(e){return/^#([0-9a-f]{6}|[0-9a-f]{8})$/i.test(e)?`#${e.replace("#","").slice(0,6)}`:"#000000"}function g(e){return/^#[0-9a-f]{6}([0-9a-f]{2})?$/i.test(e.trim())}function E(e){let t=e.trim();return t.startsWith("#")||(t="#"+t),t.toUpperCase()}function h(e){const t=e.target,a=t.dataset.key;let o=t.value.trim();const l=t.parentElement,i=l.querySelector('input[type="text"][data-key="'+a+'"]'),d=l.querySelector('input[type="color"][data-key="'+a+'"]'),r=l.querySelector('input[type="range"][data-alpha-key="'+a+'"]');if("color"===t.type){const e=o,t=T(i?.value||""),n=A(e,t);i.value=n,r.value=String(t),o=n}else"text"===t.type&&g(o)&&(d.value=k(o),r.value=String(T(o)),i.classList.remove("invalid"),i.setAttribute("aria-invalid","false"));if(!g(o))return i.classList.add("invalid"),void i.setAttribute("aria-invalid","true");i.classList.remove("invalid"),i.setAttribute("aria-invalid","false"),u(),s.colors[a]=E(o),C(),n.postMessage({type:"LOCATE",payload:{elementId:I(a)}})}function S(e){const t=e.target,a=t.dataset.alphaKey,o=t.parentElement,l=o.querySelector('input[type="color"][data-key="'+a+'"]'),i=o.querySelector('input[type="text"][data-key="'+a+'"]'),d=L(parseInt(t.value,10)),r=A(l.value,d);i.value=r,u(),s.colors[a]=r,C(),n.postMessage({type:"LOCATE",payload:{elementId:I(a)}})}function L(e){return isFinite(e)?Math.min(100,Math.max(0,e)):100}function T(e){const t=/^#[0-9a-f]{6}([0-9a-f]{2})$/i.exec(e);if(!t)return 100;const n=parseInt(t[1],16);return Math.round(n/255*100)}function A(e,t){const n=k(e).replace("#",""),a=L(t);return`#${n}${Math.round(a/100*255).toString(16).padStart(2,"0")}`}function $(){const e=document.getElementById("panel-tokens"),t=s.tokenColors.map((e,t)=>function(e,t){const n=(e.settings.fontStyle||"").split(/\s+/).filter(Boolean),a=e=>n.includes(e);return`<div class="row">\n\t\t<label>scope</label><input data-token-edit aria-label="Token scope" data-index="${t}" data-field="scope" value="${Array.isArray(e.scope)?e.scope.join(", "):e.scope||""}" />\n    <label>foreground</label><input data-token-edit aria-label="Token foreground color" data-index="${t}" data-field="fg" value="${e.settings.foreground||""}" />\n\t\t<fieldset style="display:inline-flex;gap:6px;border:none;padding:0;margin:0">\n\t\t\t<label><input type="checkbox" data-fs data-index="${t}" value="bold" ${a("bold")?"checked":""}/> bold</label>\n\t\t\t<label><input type="checkbox" data-fs data-index="${t}" value="italic" ${a("italic")?"checked":""}/> italic</label>\n\t\t\t<label><input type="checkbox" data-fs data-index="${t}" value="underline" ${a("underline")?"checked":""}/> underline</label>\n\t\t\t<label><input type="checkbox" data-fs data-index="${t}" value="strikethrough" ${a("strikethrough")?"checked":""}/> strikethrough</label>\n\t\t</fieldset>\n\t\t<button data-token-remove data-index="${t}" aria-label="Remove token rule ${t+1}">Remove</button>\n  </div>`}(e,t)).join("");e.innerHTML=`\n\t\t<button id="add-token" aria-label="Add token rule">Add Rule</button>\n    <div>${t}</div>`,document.getElementById("add-token").addEventListener("click",()=>{u(),s.tokenColors.push({scope:"",settings:{}}),$(),C()}),e.querySelectorAll("[data-token-edit]").forEach(e=>e.addEventListener("input",e=>{const t=e.target,a=Number(t.dataset.index),o=t.dataset.field;if(u(),"scope"===o&&(s.tokenColors[a].scope=t.value),"fg"===o){const e=t.value.trim();if(!g(e))return t.classList.add("invalid"),void t.setAttribute("aria-invalid","true");t.classList.remove("invalid"),t.setAttribute("aria-invalid","false"),s.tokenColors[a].settings.foreground=E(e)}"fs"===o&&(s.tokenColors[a].settings.fontStyle=t.value),C(),n.postMessage({type:"LOCATE",payload:{elementId:"demo-editor"}})})),e.querySelectorAll("[data-token-remove]").forEach(e=>e.addEventListener("click",e=>{const t=Number(e.currentTarget.dataset.index);u(),s.tokenColors.splice(t,1),$(),C(),n.postMessage({type:"LOCATE",payload:{elementId:"demo-editor"}})})),e.querySelectorAll("[data-fs]").forEach(e=>e.addEventListener("change",e=>{const t=e.target,a=Number(t.dataset.index),o=t.value,l=(s.tokenColors[a].settings.fontStyle||"").split(/\s+/).filter(Boolean),i=new Set(l);u(),t.checked?i.add(o):i.delete(o),s.tokenColors[a].settings.fontStyle=Array.from(i).join(" ")||void 0,C(),n.postMessage({type:"LOCATE",payload:{elementId:"demo-editor"}})}))}function x(){const e=document.getElementById("panel-semantic"),t=Object.entries(s.semanticTokens);e.innerHTML=`\n\t\t<button id="add-sem" aria-label="Add semantic rule">Add Semantic</button>\n    <div>${t.map(([e,t],n)=>function(e,t,n){const a=(t.fontStyle||"").split(/\s+/).filter(Boolean),o=e=>a.includes(e);return`<div class="row">\n\t<label>selector</label><input data-sem aria-label="Semantic selector" data-index="${n}" data-field="selector" value="${e}"/>\n\t<label>foreground</label><input data-sem aria-label="Semantic foreground color" data-index="${n}" data-field="fg" value="${t.foreground||""}"/>\n\t\t<fieldset style="display:inline-flex;gap:6px;border:none;padding:0;margin:0">\n\t\t\t<label><input type="checkbox" data-sem-fs data-index="${n}" value="bold" ${o("bold")?"checked":""}/> bold</label>\n\t\t\t<label><input type="checkbox" data-sem-fs data-index="${n}" value="italic" ${o("italic")?"checked":""}/> italic</label>\n\t\t\t<label><input type="checkbox" data-sem-fs data-index="${n}" value="underline" ${o("underline")?"checked":""}/> underline</label>\n\t\t</fieldset>\n\t\t<button data-sem-remove data-index="${n}" aria-label="Remove semantic rule ${n+1}">Remove</button>\n  </div>`}(e,t,n)).join("")}</div>`,document.getElementById("add-sem").addEventListener("click",()=>{u(),s.semanticTokens["entity.name.new"]={},x(),C()}),e.querySelectorAll("[data-sem]").forEach(e=>e.addEventListener("input",e=>{const t=e.target,n=Number(t.dataset.index),a=Object.keys(s.semanticTokens)[n];if(u(),"selector"===t.dataset.field){const e=t.value,n=s.semanticTokens[a];delete s.semanticTokens[a],s.semanticTokens[e]=n}else if("fg"===t.dataset.field){const e=t.value.trim();if(!g(e))return t.classList.add("invalid"),void t.setAttribute("aria-invalid","true");t.classList.remove("invalid"),t.setAttribute("aria-invalid","false"),s.semanticTokens[a].foreground=E(e)}else"fs"===t.dataset.field&&(s.semanticTokens[a].fontStyle=t.value);C()})),e.querySelectorAll("[data-sem-remove]").forEach(e=>e.addEventListener("click",e=>{const t=Number(e.currentTarget.dataset.index),n=Object.keys(s.semanticTokens)[t];u(),delete s.semanticTokens[n],x(),C()})),e.querySelectorAll("[data-sem-fs]").forEach(e=>e.addEventListener("change",e=>{const t=e.target,n=Number(t.dataset.index),a=Object.keys(s.semanticTokens)[n],o=(s.semanticTokens[a].fontStyle||"").split(/\s+/).filter(Boolean),l=new Set(o);u(),t.checked?l.add(t.value):l.delete(t.value),s.semanticTokens[a].fontStyle=Array.from(l).join(" ")||void 0,C()}))}function C(){a&&window.clearTimeout(a),a=window.setTimeout(()=>{const e=JSON.stringify(s);if(e!==o){o=e,n.postMessage({type:"APPLY_PREVIEW",payload:s});try{n.setState&&n.setState({model:s,ui:q()})}catch{}}},120)}function q(){const e=document.querySelector(".tab.active"),t=e?.dataset.tab||"colors",n=document.querySelector(".ptab.active");return{leftTab:t,previewTab:n?.dataset.demo||"editor",search:document.getElementById("search")?.value||""}}function w(){try{n.setState&&n.setState({model:s,ui:q()})}catch{}}function I(e){return e.startsWith("statusBar")?"demo-statusbar":e.startsWith("panel")||e.startsWith("panelSection")?"demo-panels":e.startsWith("terminal")?"demo-terminal":e.startsWith("problems")?"demo-problems":e.startsWith("tab.")||e.startsWith("editorGroupHeader")?"demo-lists":"demo-editor"}function B(e){return Array.isArray(e)?e.map(e=>e.trim()).join(","):String(e||"").trim()}window.addEventListener("message",n=>{const{type:a,payload:o}=n.data;if("BOOT"===a){f=o.categories||[];const n=o.settings||{};if(e?s=c(e):(s.colors=n.colors||{},s.tokenColors=n.tokenColors?.textMateRules||[],s.semanticTokens=n.semanticTokens?.rules||{}),b(),v(),t){const e=t.leftTab||"colors";document.querySelectorAll(".tab").forEach(e=>e.classList.remove("active")),document.querySelector(`[data-tab="${e}"]`)?.classList.add("active"),document.querySelectorAll(".panel").forEach(e=>e.classList.remove("active")),document.getElementById("panel-"+e)?.classList.add("active");const n=t.previewTab||"editor";if(document.querySelectorAll(".ptab").forEach(e=>e.classList.remove("active")),document.querySelector(`[data-demo="${n}"]`)?.classList.add("active"),document.querySelectorAll(".demo").forEach(e=>e.style.display="none"),document.getElementById("demo-"+n).style.display="block","string"==typeof t.search){const e=document.getElementById("search");e.value=t.search;const n=new Event("input");e.dispatchEvent(n)}}}var l,i;"LOAD_CURRENT"===a&&(s.colors=(l=s.colors,i=o.colors||{},{...i,...l}),s.tokenColors=function(e,t){const n=new Map;for(const t of e)n.set(B(t.scope),t);for(const e of t){const t=B(e.scope);n.has(t)||n.set(t,e)}return Array.from(n.values())}(s.tokenColors,o.tokenColors||[]),s.semanticTokens=function(e,t){return{...t,...e}}(s.semanticTokens,o.semanticTokens||{}),b(),v(),C()),"LOAD_IMPORTED"===a&&(s.colors=o.colors||{},s.tokenColors=o.tokenColors||[],s.semanticTokens=o.semanticTokens||{},b(),v(),C()),"LOCATE"===a&&function(e){if(!e)return;const t=document.getElementById(e);t&&(t.classList.add("locate-pulse"),setTimeout(()=>t.classList.remove("locate-pulse"),1e3))}(o?.elementId),"UI_UNDO"===a&&m(),"UI_REDO"===a&&p()}),document.addEventListener("DOMContentLoaded",()=>{const e=e=>document.getElementById(e);e("btn-import")?.addEventListener("click",()=>n.postMessage({type:"REQUEST_IMPORT"})),e("btn-use")?.addEventListener("click",()=>n.postMessage({type:"REQUEST_USE_CURRENT"})),e("btn-blank")?.addEventListener("click",()=>n.postMessage({type:"REQUEST_START_BLANK"})),e("btn-undo")?.addEventListener("click",()=>{m()}),e("btn-redo")?.addEventListener("click",()=>{p()}),e("btn-export-json")?.addEventListener("click",()=>n.postMessage({type:"REQUEST_EXPORT_JSON"})),e("btn-export-css")?.addEventListener("click",()=>n.postMessage({type:"REQUEST_EXPORT_CSS"})),e("btn-export-vsix")?.addEventListener("click",()=>n.postMessage({type:"REQUEST_EXPORT_VSIX"})),document.querySelectorAll(".tab").forEach(e=>e.addEventListener("click",()=>{document.querySelectorAll(".tab").forEach(e=>e.classList.remove("active")),e.classList.add("active");const t=e.dataset.tab;document.querySelectorAll(".panel").forEach(e=>e.classList.remove("active")),document.getElementById("panel-"+t).classList.add("active"),w()}));const t=document.getElementById("search");t.addEventListener("input",()=>{const e=t.value.toLowerCase();document.querySelectorAll("#panel-colors section").forEach(t=>{let n=!1;t.querySelectorAll(".row").forEach(t=>{const a=(t.textContent?.toLowerCase()||"").includes(e);t.style.display=a?"":"none",a&&(n=!0)}),t.style.display=n?"":"none"}),document.querySelectorAll("#panel-tokens .row").forEach(t=>{const n=t.textContent?.toLowerCase()||"";t.style.display=n.includes(e)?"":"none"}),document.querySelectorAll("#panel-semantic .row").forEach(t=>{const n=t.textContent?.toLowerCase()||"";t.style.display=n.includes(e)?"":"none"}),w()}),window.addEventListener("keydown",e=>{if(!e.ctrlKey&&!e.metaKey)return;const t=e.key.toLowerCase();"z"===t?(e.preventDefault(),e.shiftKey?p():m()):"y"===t&&(e.preventDefault(),p())}),y(),n.postMessage({type:"REQUEST_BOOT"})})})();
//# sourceMappingURL=webview.js.map